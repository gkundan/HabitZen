<% if (habit.log && habit.log.length) { %>
<h2>Habit Log</h2>
<ul>
  <% habit.log.forEach(entry => { %>
  <li>
    <span><%= entry.date.toLocaleDateString() %></span>
    <span><%= entry.action %></span>
    <form
      method="POST"
      action="/habit/<%= habit._id %>/log/<%= entry._id %>/update"
    >
      <label for="done">Done</label>
      <input type="radio" id="done" name="action" value="done" <%= entry.action
      === "done" ? "checked" : "" %>>
      <label for="notdone">Not Done</label>
      <input type="radio" id="notdone" name="action" value="notdone" <%=
      entry.action === "notdone" ? "checked" : "" %>>
      <label for="noaction">No Action</label>
      <input type="radio" id="noaction" name="action" value="noaction" <%=
      entry.action === "noaction" ? "checked" : "" %>>
      <button type="submit">Update</button>
    </form>
  </li>
  <% }) %>
</ul>
<% } else { %>
<p>No log entries found for this habit.</p>
<% } %>

<h2>Add Entry</h2>
<form method="POST" action="/habit/<%= habit._id %>/log/create">
  <label for="entry-date">Date:</label>
  <input type="date" id="entry-date" name="date" required />
  <label for="entry-action">Action:</label>
  <select id="entry-action" name="action" required>
    <option value="done">Done</option>
    <option value="notdone">Not Done</option>
    <option value="noaction">No Action</option>
  </select>
  <button type="submit">Add Entry</button>
</form>

<div id="calendar"></div>

<script src="/assets/js/main.js"></script>
<script>
  // Initialize calendar with habit log entries
  const entries = <%= JSON.stringify(habit.log) %>;
  const calendarEl = document.getElementById('calendar');
  const calendar = new FullCalendar.Calendar(calendarEl, {
    initialView: 'dayGridMonth',
    events: entries.map(entry => ({
      title: entry.action === "done" ? "âœ“" : (entry.action === "notdone" ? "X" : "-"),
      date: entry.date
    }))
  });
  calendar.render();
</script>

<!-- //create log -->
